language: java
jdk:
- openjdk8
addons:
  ssh_known_hosts:
  - 116.196.86.186:3222
install:
 - ./mvnw clean
script: ./mvnw clean package -Dmaven.test.skip=true -DskipTests
after_success:
- ls -al
- cat ~/.ssh/config
- pwd
- scp  -o stricthostkeychecking=no  -P 3222 -r -v restart.sh web@116.196.86.186:/home/web/b_proxy/travis/
- scp  -o stricthostkeychecking=no  -P 3222 -r -v start/target/b_proxy.jar web@116.196.86.186:/home/web/b_proxy/travis/
- ssh web@116.196.86.186 -p 3222 -o stricthostkeychecking=no "sh /home/web/b_proxy/travis/restart.sh
  aliyun 8092"
branches:
  only:
  - master
before_install:
- openssl aes-256-cbc -K $encrypted_9b2d7e19d83c_key -iv $encrypted_9b2d7e19d83c_iv
  -in id_rsa.enc -out ~/.ssh/id_rsa -d
- chmod 600  ~/.ssh/id_rsa 
- eval "$(ssh-agent -s)"
- echo -e "Host 116.196.86.186\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config
- chmod a+x ./mvnw
- ssh-add ~/.ssh/id_rsa
- ping 116.196.86.186 -c 10

